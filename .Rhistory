for(i in 1001:1038){
filename <- paste("../data/raw/",i,", All Data, Proc, June 2020.xlsx", sep = "")
df.keto <- read_excel(filename, sheet = "Ketosis")
all_keto_raw <- bind_rows(all_keto_raw, df.keto) %>%
group_by(FarmNo, CowId) %>%
arrange(DFC, .by_group = TRUE)
}
setwd("C:/Users/user/good-enough-project-template")
all_keto_raw <- data.frame()
for(i in 1001:1038){
filename <- paste("../data/raw/",i,", All Data, Proc, June 2020.xlsx", sep = "")
df.keto <- read_excel(filename, sheet = "Ketosis")
all_keto_raw <- bind_rows(all_keto_raw, df.keto) %>%
group_by(FarmNo, CowId) %>%
arrange(DFC, .by_group = TRUE)
}
read_excel("../data/raw, 1001 All Data Proc June 2020.xlsx", sep = "")
read_excel("data/raw/1001, All Data, Proc, June 2020.xlsx")
read_excel("../data/raw/1001, All Data, Proc, June 2020.xlsx")
setwd("C:/Users/user/good-enough-project-template")
paste("../data/raw/",i,", All Data, Proc, June 2020.xlsx", sep = "")
read_excel("../data/raw/1001, All Data, Proc, June 2020.xlsx")
paste("../data/raw/",i,", All Data, Proc, June 2020.xlsx", sep = "")
df.keto <- read_excel(filename, sheet = "Ketosis")
all_keto_raw <- data.frame()
for(i in 1001:1038){
filename <- paste("../data/raw/",i,", All Data, Proc, June 2020.xlsx", sep = "")
df.keto <- read_excel(filename, sheet = "Ketosis")
all_keto_raw <- bind_rows(all_keto_raw, df.keto) %>%
group_by(FarmNo, CowId) %>%
arrange(DFC, .by_group = TRUE)
}
paste("../data/raw/",i,", All Data, Proc, June 2020.xlsx", sep = "")
df.lact <- all_farm %>%
select(CowId, FarmNo, CalvingDate, Lactation, PeakYield, PeakDim) %>%
distinct(CowId, FarmNo, Lactation, CalvingDate, .keep_all=TRUE)
all_milk_raw <- data.frame()
for (i in 1001:1038) {
filename <- paste("../data/raw/",i,", All Data, Proc, June 2020.xlsx", sep = "")
df.milk <- read_excel(filename, sheet = "MilkData")
df.cowinfo <- read_excel(filename, sheet = "CowInfo")
# change the column name of cowinfo (CowID -> CowId)
colnames(df.cowinfo)[colnames(df.cowinfo)=="CowID"] <- "CowId"
df.cowinfo$BirthDate <- as.character(df.cowinfo$BirthDate)
df.milkfarm <- merge(df.cowinfo, df.milk, by = "CowId", all.x= TRUE, all.y=TRUE) %>%
group_by(FarmNo, CowId) %>%
arrange(DFC, .by_group = TRUE)
all_milk_raw <- bind_rows(all_milk_raw, df.milkfarm)
}
setwd("C:/Users/user/good-enough-project-template")
#########################
#   Merge Reproduction  #
#########################
# Merge reproduction data from 38 farms
# empty the data frame first
all_farm_raw <- data.frame()
for (i in 1001:1038) {
# create the excel file name base on the input i
filename <- paste("../data/raw/", i,", All Data, Proc, June 2020.xlsx", sep = "")
# load the sheets within the same excel file (the same farm)
df.calving <- read_excel(filename, sheet = "Calving")
df.cowinfo <- read_excel(filename, sheet = "CowInfo")
# change the column name of cowinfo (CowID -> CowId)
colnames(df.cowinfo)[colnames(df.cowinfo)=="CowID"] <- "CowId"
# change the column BirthDate into character
df.cowinfo$BirthDate <- as.character(df.cowinfo$BirthDate)
df.culldata <- read_excel(filename, sheet = "CullData")
df.calving <- read_excel(filename, sheet = "Calving")
df.insemination <- read_excel(filename, sheet = "Insemination")
df.pregnancy <- read_excel(filename, sheet = "Pregnancy")
# merge the data of different sheets within the same farm
df.farm <- merge(df.cowinfo, df.calving, by = "CowId", all.x=TRUE, all.y=TRUE) %>%
merge(df.culldata, by = "CowId", all.x = TRUE, all.y=TRUE) %>%
merge(df.insemination, by = "CowId", all.x=TRUE, all.y=TRUE) %>%
merge(df.pregnancy, by = "CowId", all.x=TRUE, all.y=TRUE)
# append all the merged data into the master final data table
all_farm_raw <- bind_rows(all_farm_raw, df.farm)
}
#########################
#   Merge Reproduction  #
#########################
# Merge reproduction data from 38 farms
# empty the data frame first
all_farm_raw <- data.frame()
for (i in 1001:1038) {
# create the excel file name base on the input i
filename <- paste("../data/raw/", i,", All Data, Proc, June 2020.xlsx", sep = "")
# load the sheets within the same excel file (the same farm)
df.calving <- read_excel(filename, sheet = "Calving")
df.cowinfo <- read_excel(filename, sheet = "CowInfo")
# change the column name of cowinfo (CowID -> CowId)
colnames(df.cowinfo)[colnames(df.cowinfo)=="CowID"] <- "CowId"
# change the column BirthDate into character
df.cowinfo$BirthDate <- as.character(df.cowinfo$BirthDate)
df.culldata <- read_excel(filename, sheet = "CullData")
df.calving <- read_excel(filename, sheet = "Calving")
df.insemination <- read_excel(filename, sheet = "Insemination")
df.pregnancy <- read_excel(filename, sheet = "Pregnancy")
# merge the data of different sheets within the same farm
df.farm <- merge(df.cowinfo, df.calving, by = "CowId", all.x=TRUE, all.y=TRUE) %>%
merge(df.culldata, by = "CowId", all.x = TRUE, all.y=TRUE) %>%
merge(df.insemination, by = "CowId", all.x=TRUE, all.y=TRUE) %>%
merge(df.pregnancy, by = "CowId", all.x=TRUE, all.y=TRUE)
# append all the merged data into the master final data table
all_farm_raw <- bind_rows(all_farm_raw, df.farm)
}
knitr::opts_chunk$set(echo = TRUE)
all_keto_raw <- data.frame()
for(i in 1001:1038){
filename <- paste("../data/raw/",i,", All Data, Proc, June 2020.xlsx", sep = "")
df.keto <- read_excel(filename, sheet = "Ketosis")
all_keto_raw <- bind_rows(all_keto_raw, df.keto) %>%
group_by(FarmNo, CowId) %>%
arrange(DFC, .by_group = TRUE)
}
library(readxl)
library(tidyr)
library(tidyverse)
library(dplyr)
library(ggplot2)
library(reader)
library(lubridate)
library(docstring)
library(roxygen2)
all_keto_raw <- data.frame()
for(i in 1001:1038){
filename <- paste("../data/raw/",i,", All Data, Proc, June 2020.xlsx", sep = "")
df.keto <- read_excel(filename, sheet = "Ketosis")
all_keto_raw <- bind_rows(all_keto_raw, df.keto) %>%
group_by(FarmNo, CowId) %>%
arrange(DFC, .by_group = TRUE)
}
setwd("C:/Users/user/good-enough-project-template")
all_keto_raw <- data.frame()
for(i in 1001:1038){
filename <- paste("../data/raw/",i,", All Data, Proc, June 2020.xlsx", sep = "")
df.keto <- read_excel(filename, sheet = "Ketosis")
all_keto_raw <- bind_rows(all_keto_raw, df.keto) %>%
group_by(FarmNo, CowId) %>%
arrange(DFC, .by_group = TRUE)
}
all_keto_raw <- data.frame()
for(i in 1001:1038){
filename <- paste("../data/raw/",i,", All Data, Proc, June 2020.xlsx", sep = "")
df.keto <- read_excel(filename, sheet = "Ketosis")
all_keto_raw <- bind_rows(all_keto_raw, df.keto) %>%
group_by(FarmNo, CowId) %>%
arrange(DFC, .by_group = TRUE)
}
all_keto_raw <- data.frame()
for(i in 1001:1038){
filename <- paste("../data/raw/",i,", All Data, Proc, June 2020.xlsx", sep = "")
df.keto <- read_excel(filename, sheet = "Ketosis")
all_keto_raw <- bind_rows(all_keto_raw, df.keto) %>%
group_by(FarmNo, CowId) %>%
arrange(DFC, .by_group = TRUE)
}
all_keto_raw <- data.frame()
for(i in 1001:1038){
filename <- paste("~/data/raw/",i,", All Data, Proc, June 2020.xlsx", sep = "")
df.keto <- read_excel(filename, sheet = "Ketosis")
all_keto_raw <- bind_rows(all_keto_raw, df.keto) %>%
group_by(FarmNo, CowId) %>%
arrange(DFC, .by_group = TRUE)
}
all_keto_raw <- data.frame()
for(i in 1001:1038){
filename <- paste("../data/raw/",i,", All Data, Proc, June 2020.xlsx", sep = "")
df.keto <- read_excel(filename, sheet = "Ketosis")
all_keto_raw <- bind_rows(all_keto_raw, df.keto) %>%
group_by(FarmNo, CowId) %>%
arrange(DFC, .by_group = TRUE)
}
library(readxl)
library(tidyr)
library(tidyverse)
library(dplyr)
library(ggplot2)
library(reader)
library(lubridate)
library(docstring)
library(roxygen2)
#########################
#   Merge Reproduction  #
#########################
# Merge reproduction data from 38 farms
# empty the data frame first
all_farm_raw <- data.frame()
for (i in 1001:1038) {
# create the excel file name base on the input i
filename <- paste("../data/raw/", i,", All Data, Proc, June 2020.xlsx", sep = "")
# load the sheets within the same excel file (the same farm)
df.calving <- read_excel(filename, sheet = "Calving")
df.cowinfo <- read_excel(filename, sheet = "CowInfo")
# change the column name of cowinfo (CowID -> CowId)
colnames(df.cowinfo)[colnames(df.cowinfo)=="CowID"] <- "CowId"
# change the column BirthDate into character
df.cowinfo$BirthDate <- as.character(df.cowinfo$BirthDate)
df.culldata <- read_excel(filename, sheet = "CullData")
df.calving <- read_excel(filename, sheet = "Calving")
df.insemination <- read_excel(filename, sheet = "Insemination")
df.pregnancy <- read_excel(filename, sheet = "Pregnancy")
# merge the data of different sheets within the same farm
df.farm <- merge(df.cowinfo, df.calving, by = "CowId", all.x=TRUE, all.y=TRUE) %>%
merge(df.culldata, by = "CowId", all.x = TRUE, all.y=TRUE) %>%
merge(df.insemination, by = "CowId", all.x=TRUE, all.y=TRUE) %>%
merge(df.pregnancy, by = "CowId", all.x=TRUE, all.y=TRUE)
# append all the merged data into the master final data table
all_farm_raw <- bind_rows(all_farm_raw, df.farm)
}
setwd("C:/Users/user/good-enough-project-template")
knitr::opts_chunk$set(echo = TRUE)
library(readxl)
library(tidyr)
library(tidyverse)
library(dplyr)
library(ggplot2)
library(reader)
library(lubridate)
library(docstring)
library(roxygen2)
#########################
#   Merge Reproduction  #
#########################
# Merge reproduction data from 38 farms
# empty the data frame first
all_farm_raw <- data.frame()
for (i in 1001:1038) {
# create the excel file name base on the input i
filename <- paste("../data/raw/", i,", All Data, Proc, June 2020.xlsx", sep = "")
# load the sheets within the same excel file (the same farm)
df.calving <- read_excel(filename, sheet = "Calving")
df.cowinfo <- read_excel(filename, sheet = "CowInfo")
# change the column name of cowinfo (CowID -> CowId)
colnames(df.cowinfo)[colnames(df.cowinfo)=="CowID"] <- "CowId"
# change the column BirthDate into character
df.cowinfo$BirthDate <- as.character(df.cowinfo$BirthDate)
df.culldata <- read_excel(filename, sheet = "CullData")
df.calving <- read_excel(filename, sheet = "Calving")
df.insemination <- read_excel(filename, sheet = "Insemination")
df.pregnancy <- read_excel(filename, sheet = "Pregnancy")
# merge the data of different sheets within the same farm
df.farm <- merge(df.cowinfo, df.calving, by = "CowId", all.x=TRUE, all.y=TRUE) %>%
merge(df.culldata, by = "CowId", all.x = TRUE, all.y=TRUE) %>%
merge(df.insemination, by = "CowId", all.x=TRUE, all.y=TRUE) %>%
merge(df.pregnancy, by = "CowId", all.x=TRUE, all.y=TRUE)
# append all the merged data into the master final data table
all_farm_raw <- bind_rows(all_farm_raw, df.farm)
}
#merge daily measurement of milkdata and ketosis into one data frame
for(i in 1001:1038){
# create the excel file name base on the input i
filename <- paste("C:/Data/",i,", All Data, Proc, June 2020.xlsx", sep = "")
# load the sheets within the same excel file (the same farm)
df.milk <- read_excel(filename, sheet = "MilkData")
df.keto <- read_excel(filename, sheet = "Ketosis")
# merge the data of different sheets within the same farm
df.farmdaily <- merge(df.milk, df.keto, by = "CowId")
# append all the merged data into the master final data table
all_farm_daily <- bind_rows(all_farm_daily, df.farmdaily)
}
all_farm_daily <- data.frame()
#merge daily measurement of milkdata and ketosis into one data frame
for(i in 1001:1038){
# create the excel file name base on the input i
filename <- paste("C:/Data/",i,", All Data, Proc, June 2020.xlsx", sep = "")
# load the sheets within the same excel file (the same farm)
df.milk <- read_excel(filename, sheet = "MilkData")
df.keto <- read_excel(filename, sheet = "Ketosis")
# merge the data of different sheets within the same farm
df.farmdaily <- merge(df.milk, df.keto, by = "CowId")
# append all the merged data into the master final data table
all_farm_daily <- bind_rows(all_farm_daily, df.farmdaily)
}
#########################
#   Merge Reproduction  #
#########################
# Merge reproduction data from 38 farms
# empty the data frame first
all_farm_raw <- data.frame()
for (i in 1001:1038) {
# create the excel file name base on the input i
filename <- paste("./data/raw/", i,", All Data, Proc, June 2020.xlsx", sep = "")
# load the sheets within the same excel file (the same farm)
df.calving <- read_excel(filename, sheet = "Calving")
df.cowinfo <- read_excel(filename, sheet = "CowInfo")
# change the column name of cowinfo (CowID -> CowId)
colnames(df.cowinfo)[colnames(df.cowinfo)=="CowID"] <- "CowId"
# change the column BirthDate into character
df.cowinfo$BirthDate <- as.character(df.cowinfo$BirthDate)
df.culldata <- read_excel(filename, sheet = "CullData")
df.calving <- read_excel(filename, sheet = "Calving")
df.insemination <- read_excel(filename, sheet = "Insemination")
df.pregnancy <- read_excel(filename, sheet = "Pregnancy")
# merge the data of different sheets within the same farm
df.farm <- merge(df.cowinfo, df.calving, by = "CowId", all.x=TRUE, all.y=TRUE) %>%
merge(df.culldata, by = "CowId", all.x = TRUE, all.y=TRUE) %>%
merge(df.insemination, by = "CowId", all.x=TRUE, all.y=TRUE) %>%
merge(df.pregnancy, by = "CowId", all.x=TRUE, all.y=TRUE)
# append all the merged data into the master final data table
all_farm_raw <- bind_rows(all_farm_raw, df.farm)
}
for (i in 1001:1038) {
# create the excel file name base on the input i
filename <- paste("./data/raw/", i,", All Data, Proc, June 2020.xlsx", sep = "")
# load the sheets within the same excel file (the same farm)
df.calving <- read_excel(filename, sheet = "Calving")
df.cowinfo <- read_excel(filename, sheet = "CowInfo")
# change the column name of cowinfo (CowID -> CowId)
colnames(df.cowinfo)[colnames(df.cowinfo)=="CowID"] <- "CowId"
# change the column BirthDate into character
df.cowinfo$BirthDate <- as.character(df.cowinfo$BirthDate)
df.culldata <- read_excel(filename, sheet = "CullData")
df.calving <- read_excel(filename, sheet = "Calving")
df.insemination <- read_excel(filename, sheet = "Insemination")
df.pregnancy <- read_excel(filename, sheet = "Pregnancy")
# merge the data of different sheets within the same farm
df.farm <- merge(df.cowinfo, df.calving, by = "CowId", all.x=TRUE, all.y=TRUE) %>%
merge(df.culldata, by = "CowId", all.x = TRUE, all.y=TRUE) %>%
merge(df.insemination, by = "CowId", all.x=TRUE, all.y=TRUE) %>%
merge(df.pregnancy, by = "CowId", all.x=TRUE, all.y=TRUE)
# append all the merged data into the master final data table
all_farm_raw <- bind_rows(all_farm_raw, df.farm)
}
for (i in 1001:1038) {
# create the excel file name base on the input i
filename <- paste("./good-enough-project-template/data/raw/", i,", All Data, Proc, June 2020.xlsx", sep = "")
# load the sheets within the same excel file (the same farm)
df.calving <- read_excel(filename, sheet = "Calving")
df.cowinfo <- read_excel(filename, sheet = "CowInfo")
# change the column name of cowinfo (CowID -> CowId)
colnames(df.cowinfo)[colnames(df.cowinfo)=="CowID"] <- "CowId"
# change the column BirthDate into character
df.cowinfo$BirthDate <- as.character(df.cowinfo$BirthDate)
df.culldata <- read_excel(filename, sheet = "CullData")
df.calving <- read_excel(filename, sheet = "Calving")
df.insemination <- read_excel(filename, sheet = "Insemination")
df.pregnancy <- read_excel(filename, sheet = "Pregnancy")
# merge the data of different sheets within the same farm
df.farm <- merge(df.cowinfo, df.calving, by = "CowId", all.x=TRUE, all.y=TRUE) %>%
merge(df.culldata, by = "CowId", all.x = TRUE, all.y=TRUE) %>%
merge(df.insemination, by = "CowId", all.x=TRUE, all.y=TRUE) %>%
merge(df.pregnancy, by = "CowId", all.x=TRUE, all.y=TRUE)
# append all the merged data into the master final data table
all_farm_raw <- bind_rows(all_farm_raw, df.farm)
}
for (i in 1001:1038) {
# create the excel file name base on the input i
filename <- paste("../data/raw/", i,", All Data, Proc, June 2020.xlsx", sep = "")
# load the sheets within the same excel file (the same farm)
df.calving <- read_excel(filename, sheet = "Calving")
df.cowinfo <- read_excel(filename, sheet = "CowInfo")
# change the column name of cowinfo (CowID -> CowId)
colnames(df.cowinfo)[colnames(df.cowinfo)=="CowID"] <- "CowId"
# change the column BirthDate into character
df.cowinfo$BirthDate <- as.character(df.cowinfo$BirthDate)
df.culldata <- read_excel(filename, sheet = "CullData")
df.calving <- read_excel(filename, sheet = "Calving")
df.insemination <- read_excel(filename, sheet = "Insemination")
df.pregnancy <- read_excel(filename, sheet = "Pregnancy")
# merge the data of different sheets within the same farm
df.farm <- merge(df.cowinfo, df.calving, by = "CowId", all.x=TRUE, all.y=TRUE) %>%
merge(df.culldata, by = "CowId", all.x = TRUE, all.y=TRUE) %>%
merge(df.insemination, by = "CowId", all.x=TRUE, all.y=TRUE) %>%
merge(df.pregnancy, by = "CowId", all.x=TRUE, all.y=TRUE)
# append all the merged data into the master final data table
all_farm_raw <- bind_rows(all_farm_raw, df.farm)
}
for (i in 1001:1038) {
# create the excel file name base on the input i
filename <- paste("~/data/raw/", i,", All Data, Proc, June 2020.xlsx", sep = "")
# load the sheets within the same excel file (the same farm)
df.calving <- read_excel(filename, sheet = "Calving")
df.cowinfo <- read_excel(filename, sheet = "CowInfo")
# change the column name of cowinfo (CowID -> CowId)
colnames(df.cowinfo)[colnames(df.cowinfo)=="CowID"] <- "CowId"
# change the column BirthDate into character
df.cowinfo$BirthDate <- as.character(df.cowinfo$BirthDate)
df.culldata <- read_excel(filename, sheet = "CullData")
df.calving <- read_excel(filename, sheet = "Calving")
df.insemination <- read_excel(filename, sheet = "Insemination")
df.pregnancy <- read_excel(filename, sheet = "Pregnancy")
# merge the data of different sheets within the same farm
df.farm <- merge(df.cowinfo, df.calving, by = "CowId", all.x=TRUE, all.y=TRUE) %>%
merge(df.culldata, by = "CowId", all.x = TRUE, all.y=TRUE) %>%
merge(df.insemination, by = "CowId", all.x=TRUE, all.y=TRUE) %>%
merge(df.pregnancy, by = "CowId", all.x=TRUE, all.y=TRUE)
# append all the merged data into the master final data table
all_farm_raw <- bind_rows(all_farm_raw, df.farm)
}
#########################
#   Merge Reproduction  #
#########################
# Merge reproduction data from 38 farms
# empty the data frame first
all_farm_raw <- data.frame()
for (i in 1001:1038) {
# create the excel file name base on the input i
filename <- paste("../data/raw/", i,", All Data, Proc, June 2020.xlsx", sep = "")
# load the sheets within the same excel file (the same farm)
df.calving <- read_excel(filename, sheet = "Calving")
df.cowinfo <- read_excel(filename, sheet = "CowInfo")
# change the column name of cowinfo (CowID -> CowId)
colnames(df.cowinfo)[colnames(df.cowinfo)=="CowID"] <- "CowId"
# change the column BirthDate into character
df.cowinfo$BirthDate <- as.character(df.cowinfo$BirthDate)
df.culldata <- read_excel(filename, sheet = "CullData")
df.calving <- read_excel(filename, sheet = "Calving")
df.insemination <- read_excel(filename, sheet = "Insemination")
df.pregnancy <- read_excel(filename, sheet = "Pregnancy")
# merge the data of different sheets within the same farm
df.farm <- merge(df.cowinfo, df.calving, by = "CowId", all.x=TRUE, all.y=TRUE) %>%
merge(df.culldata, by = "CowId", all.x = TRUE, all.y=TRUE) %>%
merge(df.insemination, by = "CowId", all.x=TRUE, all.y=TRUE) %>%
merge(df.pregnancy, by = "CowId", all.x=TRUE, all.y=TRUE)
# append all the merged data into the master final data table
all_farm_raw <- bind_rows(all_farm_raw, df.farm)
}
knitr::opts_chunk$set(echo = TRUE)
library(readxl)
library(tidyr)
library(tidyverse)
library(dplyr)
library(ggplot2)
library(reader)
library(lubridate)
library(docstring)
library(roxygen2)
#########################
#   Merge Reproduction  #
#########################
# Merge reproduction data from 38 farms
# empty the data frame first
all_farm_raw <- data.frame()
for (i in 1001:1038) {
# create the excel file name base on the input i
filename <- paste("../data/raw/", i,", All Data, Proc, June 2020.xlsx", sep = "")
# load the sheets within the same excel file (the same farm)
df.calving <- read_excel(filename, sheet = "Calving")
df.cowinfo <- read_excel(filename, sheet = "CowInfo")
# change the column name of cowinfo (CowID -> CowId)
colnames(df.cowinfo)[colnames(df.cowinfo)=="CowID"] <- "CowId"
# change the column BirthDate into character
df.cowinfo$BirthDate <- as.character(df.cowinfo$BirthDate)
df.culldata <- read_excel(filename, sheet = "CullData")
df.calving <- read_excel(filename, sheet = "Calving")
df.insemination <- read_excel(filename, sheet = "Insemination")
df.pregnancy <- read_excel(filename, sheet = "Pregnancy")
# merge the data of different sheets within the same farm
df.farm <- merge(df.cowinfo, df.calving, by = "CowId", all.x=TRUE, all.y=TRUE) %>%
merge(df.culldata, by = "CowId", all.x = TRUE, all.y=TRUE) %>%
merge(df.insemination, by = "CowId", all.x=TRUE, all.y=TRUE) %>%
merge(df.pregnancy, by = "CowId", all.x=TRUE, all.y=TRUE)
# append all the merged data into the master final data table
all_farm_raw <- bind_rows(all_farm_raw, df.farm)
}
#########################
#   Merge Reproduction  #
#########################
# Merge reproduction data from 38 farms
# empty the data frame first
all_farm_raw <- data.frame()
for (i in 1001:1038) {
# create the excel file name base on the input i
filename <- paste("../data/raw/", i,", All Data, Proc, June 2020.xlsx", sep = "")
# load the sheets within the same excel file (the same farm)
df.calving <- read_excel(filename, sheet = "Calving")
df.cowinfo <- read_excel(filename, sheet = "CowInfo")
# change the column name of cowinfo (CowID -> CowId)
colnames(df.cowinfo)[colnames(df.cowinfo)=="CowID"] <- "CowId"
# change the column BirthDate into character
df.cowinfo$BirthDate <- as.character(df.cowinfo$BirthDate)
df.culldata <- read_excel(filename, sheet = "CullData")
df.calving <- read_excel(filename, sheet = "Calving")
df.insemination <- read_excel(filename, sheet = "Insemination")
df.pregnancy <- read_excel(filename, sheet = "Pregnancy")
# merge the data of different sheets within the same farm
df.farm <- merge(df.cowinfo, df.calving, by = "CowId", all.x=TRUE, all.y=TRUE) %>%
merge(df.culldata, by = "CowId", all.x = TRUE, all.y=TRUE) %>%
merge(df.insemination, by = "CowId", all.x=TRUE, all.y=TRUE) %>%
merge(df.pregnancy, by = "CowId", all.x=TRUE, all.y=TRUE)
# append all the merged data into the master final data table
all_farm_raw <- bind_rows(all_farm_raw, df.farm)
}
#########################
#   Merge Reproduction  #
#########################
# Merge reproduction data from 38 farms
# empty the data frame first
all_farm_raw <- data.frame()
for (i in 1001:1038) {
# create the excel file name base on the input i
filename <- paste("../data/raw/", i,", All Data, Proc, June 2020.xlsx", sep = "")
# load the sheets within the same excel file (the same farm)
df.calving <- read_excel(filename, sheet = "Calving")
df.cowinfo <- read_excel(filename, sheet = "CowInfo")
# change the column name of cowinfo (CowID -> CowId)
colnames(df.cowinfo)[colnames(df.cowinfo)=="CowID"] <- "CowId"
# change the column BirthDate into character
df.cowinfo$BirthDate <- as.character(df.cowinfo$BirthDate)
df.culldata <- read_excel(filename, sheet = "CullData")
df.calving <- read_excel(filename, sheet = "Calving")
df.insemination <- read_excel(filename, sheet = "Insemination")
df.pregnancy <- read_excel(filename, sheet = "Pregnancy")
# merge the data of different sheets within the same farm
df.farm <- merge(df.cowinfo, df.calving, by = "CowId", all.x=TRUE, all.y=TRUE) %>%
merge(df.culldata, by = "CowId", all.x = TRUE, all.y=TRUE) %>%
merge(df.insemination, by = "CowId", all.x=TRUE, all.y=TRUE) %>%
merge(df.pregnancy, by = "CowId", all.x=TRUE, all.y=TRUE)
# append all the merged data into the master final data table
all_farm_raw <- bind_rows(all_farm_raw, df.farm)
}
